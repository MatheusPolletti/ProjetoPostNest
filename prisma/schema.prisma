generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                 Int          @id @default(autoincrement())
  name               String
  email              String       @unique
  password           String
  hashedRefreshToken String?
  role               Role         @default(USER)
  profileInfo        ProfileInfo?
  posts              Posts[]
  comments           Comments[]
  reaction  Reaction[]
}

model ProfileInfo {
  id       Int  @id @default(autoincrement())
  userId   Int  @unique
  user     User @relation(fields: [userId], references: [id])
  metadata Json
}

model Posts {
  id         Int        @id @default(autoincrement())
  authorId   Int
  autor      User       @relation(fields: [authorId], references: [id])
  title      String
  likes      Int        @default(0)
  dislikes   Int        @default(0)
  content    String
  comments   Comments[]
  reaction  Reaction[]
}

enum ReactionType {
  LIKE
  DISLIKE
}

model Reaction {
  userId  Int
  postId Int
  type ReactionType
  user User @relation(fields: [userId], references: [id])
  post Posts @relation(fields: [postId], references: [id])

  @@id([userId, postId])
}

model Comments {
  id       Int    @id @default(autoincrement())
  text     String
  authorId Int
  author   User   @relation(fields: [authorId], references: [id])
  postId   Int
  post     Posts  @relation(fields: [postId], references: [id])
}

enum Role {
  ADMIN
  EDITOR
  USER
}
